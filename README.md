# 🎮 FlutterGame - 橫向動作冒險遊戲

一個基於 Flutter 和 Flame 遊戲引擎開發的橫向動作冒險遊戲。玩家控制冒險者角色，使用搖桿移動和攻擊按鈕進行戰鬥，對抗怪物敵人。專案採用現代化的管理器模式架構設計，實現清晰的職責分離。

## 📱 專案簡介

FlutterGame 是一款橫向動作冒險遊戲，玩家扮演冒險者角色，在遊戲世界中移動、戰鬥，對抗各種怪物。遊戲具有流暢的動畫效果、視差背景滾動、碰撞檢測系統和生命值機制。

## ✨ 功能特點

### 核心遊戲功能
- 🎮 **角色控制**：使用搖桿控制冒險者左右移動
- ⚔️ **攻擊系統**：點擊攻擊按鈕發射弓箭攻擊怪物
- 👾 **怪物 AI**：怪物具有移動、攻擊和死亡動畫
- ❤️ **生命值系統**：玩家和怪物都有生命值顯示
- 🎯 **碰撞檢測**：精確的碰撞檢測系統，支援調試模式
- 🏹 **弓箭系統**：弓箭有射程限制和方向控制

### 視覺與動畫
- 🎬 **流暢動畫**：角色和怪物都有豐富的動畫效果
  - 玩家：正常狀態、跑步、弓箭攻擊
  - 怪物：正常狀態、行走、死亡
- 🌄 **視差背景**：多層背景視差滾動效果，營造深度感
- 📊 **生命值顯示**：即時顯示玩家和怪物的生命值條
- 🎨 **精靈表動畫**：使用精靈表實現流暢的角色動畫

### 遊戲機制
- 📷 **攝影機跟隨**：攝影機會跟隨玩家角色移動
- 🎛️ **輸入管理**：統一的輸入管理系統，處理搖桿和按鈕
- 💾 **狀態管理**：使用管理器模式進行狀態管理
- 🐛 **調試工具**：內建碰撞範圍調試按鈕

## 🏗️ 技術架構

### 架構模式
本專案採用**管理器模式**，結合依賴注入，實現清晰的職責分離。

### 架構分層

```
┌─────────────────────────────────────┐
│      Game Layer (FlameGame)        │
│  - StartGame                        │
└─────────────────────────────────────┘
                  ↓
┌─────────────────────────────────────┐
│      Controller Layer                │
│  - GameLoopController               │
└─────────────────────────────────────┘
                  ↓
┌─────────────────────────────────────┐
│      Manager Layer (Business Logic)  │
│  - GameManager                      │
│  - InputManager                     │
│  - AnimationManager                 │
│  - BackgroundManager                │
│  - AssetLoadManager                 │
└─────────────────────────────────────┘
                  ↓
┌─────────────────────────────────────┐
│      Service Layer                   │
│  - AssetService                     │
└─────────────────────────────────────┘
                  ↓
┌─────────────────────────────────────┐
│      Component Layer                 │
│  - Adventurer (玩家角色)             │
│  - Monster (怪物)                    │
│  - Arrow (弓箭)                      │
│  - LifeComponent (生命值顯示)        │
└─────────────────────────────────────┘
                  ↓
┌─────────────────────────────────────┐
│      State Layer                     │
│  - GameState                        │
│  - PlayerState                      │
│  - MonsterState                     │
│  - CollisionState                   │
└─────────────────────────────────────┘
```

### 核心設計模式

1. **管理器模式**：每個功能模組由專門的管理器負責
2. **組件模式**：使用 Flame 的組件系統組織遊戲對象
3. **依賴注入**：通過構造函數注入依賴
4. **狀態管理模式**：使用狀態類管理遊戲狀態

## 📂 專案結構

```
flutter_game/
├── lib/
│   ├── main.dart                    # 應用入口
│   ├── game/                        # 遊戲主類
│   │   └── start_game.dart          # 遊戲類
│   ├── role/                        # 遊戲角色
│   │   ├── adventurer.dart          # 冒險者（玩家）
│   │   └── monster.dart             # 怪物
│   ├── manager/                     # 管理器層
│   │   ├── game_manager.dart        # 遊戲狀態管理器
│   │   ├── input_manager.dart       # 輸入管理器
│   │   ├── animation_manager.dart   # 動畫管理器
│   │   ├── background_manager.dart  # 背景管理器
│   │   └── asset_load_manager.dart  # 資源載入管理器
│   ├── controllers/                 # 控制器層
│   │   └── game_loop_controller.dart # 遊戲循環控制器
│   ├── components/                  # 遊戲組件
│   │   ├── arrow.dart               # 弓箭組件
│   │   ├── life_component.dart      # 生命值組件
│   │   ├── damage_text.dart         # 傷害文字組件
│   │   └── unflippable_hitbox.dart  # 不可翻轉碰撞盒
│   ├── button/                      # UI 按鈕
│   │   ├── attack_button.dart       # 攻擊按鈕
│   │   └── debug_collision_button.dart # 調試碰撞按鈕
│   ├── states/                      # 狀態定義
│   │   ├── game_state.dart          # 遊戲狀態
│   │   ├── player_state.dart        # 玩家狀態
│   │   ├── monster_state.dart       # 怪物狀態
│   │   └── collision_state.dart     # 碰撞狀態
│   ├── service/                     # 服務層
│   │   └── asset_service.dart       # 資源服務
│   ├── constants/                   # 常量定義
│   │   └── game_constants.dart      # 遊戲常量
│   ├── interfaces/                  # 介面定義
│   │   └── game_manager_interface.dart # 遊戲管理器介面
│   ├── exceptions/                  # 異常定義
│   │   └── game_exceptions.dart     # 遊戲異常
│   └── extensions/                  # 擴展方法
│       └── sprite_sheet_extension.dart # 精靈表擴展
├── assets/                          # 遊戲資源
│   └── images/                      # 圖片資源
│       ├── player.png               # 玩家精靈表
│       ├── run.png                  # 跑步動畫
│       ├── attack.png               # 攻擊動畫
│       ├── bow_attack.png           # 弓箭攻擊動畫
│       ├── monster_*.png            # 怪物相關圖片
│       ├── weapon_arrow.png         # 弓箭圖片
│       └── background_*.png         # 背景圖層
├── android/                         # Android 平台配置
├── ios/                             # iOS 平台配置
├── web/                             # Web 平台配置
├── pubspec.yaml                     # 專案依賴配置
└── README.md                        # 專案說明文件
```

## 🛠️ 技術棧

### 主要依賴
- **Flutter SDK**：>=2.17.5 <3.0.0
- **Flame**：^1.4.0 (遊戲引擎)

### 核心技術
- **Flame Game Engine**：2D 遊戲引擎
- **Flutter**：跨平台 UI 框架

### 遊戲功能
- **搖桿控制**：左下角虛擬搖桿控制角色移動
- **攻擊按鈕**：右下角攻擊按鈕發射弓箭
- **調試按鈕**：左上角按鈕切換碰撞範圍顯示
- **攝影機跟隨**：自動跟隨玩家角色

## 🎮 遊戲玩法

1. 啟動遊戲後，冒險者會出現在遊戲世界中
2. 使用左下角的搖桿控制冒險者左右移動
3. 點擊右下角的攻擊按鈕發射弓箭攻擊怪物
4. 弓箭會朝角色面向的方向發射
5. 怪物會自動移動

## 🔧 核心功能實現

### 碰撞檢測
使用 Flame 的碰撞檢測系統，支援圓形和矩形碰撞盒。可以通過調試按鈕切換碰撞範圍的可視化顯示。

### 動畫系統
- **精靈表動畫**：使用 `SpriteAnimationGroupComponent` 管理多種動畫狀態
- **動畫切換**：根據角色狀態自動切換對應動畫
- **動畫同步**：確保動畫播放與遊戲邏輯同步

### 狀態管理
- **狀態類**：使用 `GameState`、`PlayerState`、`MonsterState` 等狀態類管理遊戲狀態
- **狀態同步**：自動同步角色狀態與動畫狀態

### 視差背景
使用 Flame 的 `ParallaxComponent` 實現多層背景視差滾動效果，不同圖層以不同速度滾動，營造深度感。

### 輸入處理
- **搖桿輸入**：處理虛擬搖桿的拖動輸入
- **按鈕輸入**：處理攻擊按鈕的點擊輸入
- **輸入狀態**：統一管理輸入狀態，避免衝突

## 📸 遊戲畫面展示

### 遊戲進行中
<!-- 在此處添加遊戲進行中的實機畫面動圖 -->
```
[遊戲進行中動圖預留位置]
```

### 攻擊動畫
<!-- 在此處添加攻擊動畫的實機畫面動圖 -->
```
[攻擊動畫動圖預留位置]
```

### 調試模式
<!-- 在此處添加調試模式的實機畫面動圖 -->
```
[調試模式動圖預留位置]
```

## 🎯 開發特色

### 模組化設計
採用管理器模式，每個功能模組都有專門的管理器負責，便於維護和擴展。

### 異常處理
實現了完整的異常處理系統，使用自定義異常類處理遊戲中的各種錯誤情況。

### 擴展性
使用介面和抽象類設計，便於擴展新功能和新角色。

## 👨‍💻 開發者

- **開發者**：Evan
- **專案開始時間**：待補充

## 📄 許可證

本專案僅供學習和交流使用。

## 🙏 致謝

- **Flame**：強大的 Flutter 遊戲引擎
- **Flutter**：跨平台開發框架

---

**享受遊戲，探索冒險！** 🎮⚔️

